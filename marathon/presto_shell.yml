id: "/presto/shell"
dependencies:
  - "/presto/coordinator"
uris:
  - "https://github.com/yudai/gotty/releases/download/v0.0.12/gotty_linux_amd64.tar.gz"
args:
  - "-c"
  - >
    $MESOS_SANDBOX/gotty
    --title-format "presto twitter shell"
    --permit-write
    --port 8080
    /usr/local/bin/presto
    --server coordinator-presto.marathon.mesos:12000
    --catalog cassandra
    --schema twitter
mem: 512
cpus: 1
labels:
  HAPROXY_GROUP: external
env:
  TERM: xterm
upgradeStrategy:
  minimumHealthCapacity: 0
  maximumOverCapacity: 0
container:
  type: DOCKER
  docker:
    image: !cfg_str "mesosphere/presto-cli:{{presto_version}}"
    network: BRIDGE
    portMappings:
      -
        containerPort: 8080
        protocol: "tcp"
        servicePort: 10000
    parameters:
      - key: entrypoint
        value: "/bin/bash"
healthChecks:
  -
    protocol: "HTTP"
    portIndex: 0
    gracePeriodSeconds: 15
    intervalSeconds: 5
    timeoutSeconds: 2
    maxConsecutiveFailures: 3
    ignoreHttp1xx: false
